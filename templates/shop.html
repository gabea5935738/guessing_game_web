<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div id="game-container">
        <h1>Shop</h1>
    <div id="score">Your Score: {{ score }}</div>
        <script>
        function updateIdleScore() {
            fetch("/idle_score").then(r => r.json()).then(data => {
                document.getElementById("score").textContent = "Your Score: " + data.score;
            });
        }
        setInterval(updateIdleScore, 1000);
        </script>
        {% if message %}
            <div id="message">{{ message }}</div>
        {% endif %}
        <h2>Inventory</h2>
        <ul>
            <li>Extra Guesses: {{ inventory.extra_guess }}</li>
            <li>Hints: {{ inventory.hint }}</li>
            <li>Score Multipliers: {{ inventory.score_multiplier }}</li>
            <li>Idle Generators: {{ inventory.idle_generator }}</li>
        </ul>
        <h2>Buy Items</h2>
        <form method="POST">
            <button type="submit" name="item" value="extra_guess">
                Buy Extra Guess ({{ item_costs.extra_guess }} points)
            </button>
        </form>
        <form method="POST">
            <button type="submit" name="item" value="hint">
                Buy Hint ({{ item_costs.hint }} points)
            </button>
        </form>
        <form method="POST">
            <button type="submit" name="item" value="score_multiplier">
                Buy Score Multiplier ({{ item_costs.score_multiplier }} points)
            </button>
        </form>
        <form method="POST">
            <button type="submit" name="item" value="idle_generator">
                Buy Idle Generator ({{ item_costs.idle_generator }} points)
            </button>
        </form>
        <div style="margin-top:1em;">
            <a href="{{ url_for('game') }}">Back to Game</a>
        </div>
    </div>
    {% if session.get('debug') %}
            <div id="debug-panel">
                <strong>DEBUG MODE ON</strong><br>
                <form method="post" action="/set_var" style="margin:1em 0;">
                        <input type="text" name="assignment" placeholder="var = value" required style="width:120px;">
                        <button type="submit">Set Variable</button>
                </form>
                <form method="post" action="/force_next_round" style="margin:1em 0;">
                        <button type="submit">Force Next Round</button>
                </form>
                <form method="post" action="/goto_page" style="margin:1em 0;">
                        <input type="text" name="page" placeholder="Route (e.g. /, /game)" required>
                        <button type="submit">Go To Page</button>
                </form>
                <pre>{{ session | pprint }}</pre>
                <div style="margin-top:1em; background:#222; color:#fff; padding:0.7em; border-radius:8px;">
                    <strong>All Routes:</strong>
                    <ul style="font-size:0.97em; margin:0; padding-left:1.2em;">
                        {% for route in all_routes %}
                            <li><code>{{ route.rule }}</code> ({{ route.methods }}) &rarr; <b>{{ route.endpoint }}</b></li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <script>
                function updateDebugScore() {
                        fetch("/idle_score").then(r => r.json()).then(data => {
                                let debugScore = document.getElementById("debug-live-score");
                                if (debugScore) debugScore.textContent = "Score: " + data.score;
                        });
                }
                setInterval(updateDebugScore, 1000);
            </script>
    {% endif %}
</body>
</html> 